SQL QUERY JEONGSOO KIM, JUMONG LEE

sql = 'SELECT COUNT(USERNAME) FROM USER WHERE USERNAME = %s AND PASSWORD = %s'

sql = "SELECT COUNT(USERNAME) FROM USER WHERE USERNAME = %s"

sql = "INSERT INTO USER VALUES(%s, %s)"

sql = "SELECT DISTINCT DEP FROM STUDENT_FACULTY"

sql = "INSERT INTO STUDENT_FACULTY(USERNAME, NAME,DOB, GENDER, EMAIL, ADDRESS, IS_FACULTY, DEP) VALUES(%s, %s, CAST(%s AS DATETIME), %s, %s, %s, %s, %s)"

sql = 'SELECT ISBN, TITLE, EDTION, IS_BOOK_ON_RESERVE FROM BOOK_BOOK WHERE TITLE = %s OR ISBN = %s'

sql = "SELECT ISBN, TITLE, EDTION, IS_BOOK_ON_RESERVE FROM BOOK_BOOK NATURAL JOIN AUTHORS WHERE BOOK_BOOK.ISBN = AUTHORS.ISBN AND BOOK_BOOK.TITLE = %s OR BOOK_BOOK.ISBN = %s OR AUTHOR_NAME = %s" 

sql = 'SELECT COUNT(COPY_N) FROM BOOK_COPY WHERE ISBN = %s AND IS_CHECKED_OUT = %s AND IS_ON_HOLD = %s'

sql = 'SELECT COUNT(COPY_N) FROM BOOK_COPY WHERE ISBN = %s'

sql = 'INSERT INTO ISSUED_BOOK(USERNAME, COPY_N, ISSUED_ID, DATE_OF_ISSUED, RETURN_DATE, COUNT_EXTENSION, ISBN) VALUES(%s, %s, %s,%s,%s,%s,%s)' ## user,copy,id,date,red,count,isbn

sql = 'UPDATE BOOK_COPY SET IS_ON_HOLD = %s WHERE ISBN = %s AND COPY_N = %s'

sql = "SELECT ISBN, COPY_N FROM ISSUED_BOOK WHERE ISSUED_ID = %s"

sql = "SELECT FUTURE_REQUESTER FROM BOOK_COPY WHERE ISBN = %s AND COPY_N = %s"

sql = "SELECT COUNT_EXTENSION FROM ISSUED_BOOK WHERE ISSUED_ID = %s" 

sql = "SELECT EXTENSION_DATE, RETURN_DATE FROM ISSUED_BOOK WHERE ISSUED_ID = %s"

sql = "UPDATE ISSUED_BOOK SET EXTENSION_DATE = CAST(%s AS DATETIME), RETURN_DATE = CAST(%s AS DATETIME), COUNT_EXTENSION = %s WHERE ISSUED_ID = %s;"

sql = "SELECT COPY_N, RETURN_DATE FROM ISSUED_BOOK NATURAL JOIN BOOK_COPY WHERE ISSUED_BOOK.ISBN = BOOK_COPY.ISBN AND ISSUED_BOOK.ISBN = %s AND BOOK_COPY.FUTURE_REQUESTER = NULL"

sql = "UPDATE BOOK_COPY SET FUTURE_REQUESTER = %s WHERE COPY_N = %s AND ISBN = %s"

sql = '''SELECT SUBJECT_NAME AS  'Subject', SHELF.SHELF_N AS 'Shelf Number',
        SHELF.FLOOR_N AS  'Floor Number', SHELF.AISLE_N AS  'Aisle Number', ISBN = %s
        FROM BOOK_BOOK AS BB, SHELF
        WHERE BB.SHELF_N = SHELF.SHELF_N
        LIMIT 0 , 30'''

***********************************************************************STAFF*****************************************************
sql = 'SELECT COUNT(USERNAME) FROM USER WHERE USERNAME = %s AND PASSWORD = %s'

sql = "SELECT ISBN, COPY_N FROM ISSUED_BOOK WHERE ISSUED_ID = %s"

sql = "UPDATE ISSUED_BOOK SET RETURN_DATE = CAST(%s AS DATETIME) WHERE ISSUED_ID = %s"

sql = "UPDATE BOOK_COPY SET IS_CHECKED_OUT = %s , IS_ON_HOLD = %s WHERE ISBN = %s AND COPY_N = %s"

sql = "SELECT DATE_OF_ISSUED FROM ISSUED_BOOK WHERE ISSUED_ID = %s"

sql = "DELETE * FROM ISSUED_BOOK WHERE ISSUED_ID = %s"

sql = "UPDATE BOOK_COPY SET IS_ON_HOLD = %s WHERE ISBN = %s AND COPY_N = %s"

sql = "SELECT USERNAME, ISBN, COPY_N FROM ISSUED_BOOK WHERE ISSUED_ID = %s"

sql = "SELECT RETURN_DATE FROM ISSUED_BOOK WHERE ISBN = %s AND COPY_N = %s"

sql = "UPDATE BOOK_COPY SET IS_CHECKED_OUT = %s WHERE ISBN = %s AND COPY_N = %s"

sql = "UPDATE STUDENT_FACULTY SET PENALTY = %s WHERE USERNAME = (SELECT USERNAME FROM ISSUED_BOOK WHERE ISSUED_ID = %s)"

sql = "UPDATE BOOK_COPY SET IS_CHECKED_OUT = %s WHERE ISBN = %s AND COPY_N = %s"

sql = "SELECT USERNAME FROM ISSUED_BOOK WHERE RETURN_DATE < CURDATE() AND ISBN = %s AND COPY_N = %s ORDER BY RETURN_DATE DESC LIMIT 1"

sql = "SELECT SUBJECT_NAME FROM SUBJECT"

sql = '''(SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED) AS  'Month', BOOK_BOOK.SUBJECT_NAME, COUNT( * ) AS  '#checkouts', ISSUED_BOOK.ISSUED_ID
        FROM BOOK_BOOK
        NATURAL JOIN ISSUED_BOOK
        NATURAL JOIN BOOK_COPY
        WHERE MONTH(ISSUED_BOOK.RETURN_DATE) = %s
        AND YEAR(ISSUED_BOOK.RETURN_DATE) = %s
        AND BOOK_COPY.IS_DAMAGED =  ?˜Y'
        AND SUBJECT_NAME = %s
        GROUP BY SUBJECT_NAME
        LIMIT 0 , 30) UNION (SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED) AS  'Month', BOOK_BOOK.SUBJECT_NAME, COUNT( * ) AS  '#checkouts', ISSUED_BOOK.ISSUED_ID
        FROM BOOK_BOOK
        NATURAL JOIN ISSUED_BOOK
        NATURAL JOIN BOOK_COPY
        WHERE MONTH(ISSUED_BOOK.RETURN_DATE) = %s
        AND YEAR(ISSUED_BOOK.RETURN_DATE) = %s
        AND BOOK_COPY.IS_DAMAGED =  ?˜Y'
        AND SUBJECT_NAME = %s
        GROUP BY SUBJECT_NAME
        LIMIT 0 , 30) UNION (SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED ) AS  'Month', BOOK_BOOK.SUBJECT_NAME, COUNT( * ) AS  '#checkouts', ISSUED_BOOK.ISSUED_ID
        FROM BOOK_BOOK
        NATURAL JOIN ISSUED_BOOK
        NATURAL JOIN BOOK_COPY
        WHERE MONTH(ISSUED_BOOK.RETURN_DATE) = %s
        AND YEAR(ISSUED_BOOK.RETURN_DATE) = %s
        AND BOOK_COPY.IS_DAMAGED =  ?˜Y'
        AND SUBJECT_NAME = %s
        GROUP BY SUBJECT_NAME
        LIMIT 0 , 30)'''

sql = '''(SELECT MONTH(ISSUED_BOOK.DATE_OF_ISSUED) AS 'Month', ISSUED_BOOK.USERNAME AS 'User Name', COUNT(*) AS '#checkouts'
        FROM ISSUED_BOOK
        WHERE ISSUED_BOOK.RETURN_DATE <= %s AND ISSUED_BOOK.RETURN_DATE > %s AND (ISSUED_BOOK.COUNT_EXTENSION = 0 OR ISSUED_BOOK.COUNT_EXTENSION IS NULL)
        GROUP BY USERNAME
        HAVING COUNT(*) > 1
        ORDER BY COUNT(*) DESC
        LIMIT 0, 5)
        UNION
        (SELECT MONTH(ISSUED_BOOK.DATE_OF_ISSUED) AS 'Month', ISSUED_BOOK.USERNAME AS 'User Name', COUNT(*) AS '#checkouts'
        FROM ISSUED_BOOK
        WHERE ISSUED_BOOK.RETURN_DATE <= %s AND ISSUED_BOOK.RETURN_DATE > %s AND (ISSUED_BOOK.COUNT_EXTENSION = 0 OR ISSUED_BOOK.COUNT_EXTENSION IS NULL)
        GROUP BY USERNAME
        HAVING COUNT(*) > 1
        ORDER BY COUNT(*) DESC
        LIMIT 0, 5)'''

sql = '''(
            SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED) AS  'Month', BOOK_BOOK.TITLE, COUNT( * ) AS  '#checkouts'
            FROM BOOK_BOOK
            INNER JOIN ISSUED_BOOK ON BOOK_BOOK.ISBN = ISSUED_BOOK.ISBN
            AND ISSUED_BOOK.RETURN_DATE <=  %s AND ISSUED_BOOK.RETURN_DATE > %s
            WHERE ISSUED_BOOK.COUNT_EXTENSION =0
            OR ISSUED_BOOK.COUNT_EXTENSION IS NULL 
            GROUP BY TITLE
            ORDER BY COUNT( * ) DESC
            LIMIT 0, 3
            )
            UNION (
            
            SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED) AS  'Month', BOOK_BOOK.TITLE, COUNT( * ) AS  '#checkouts'
            FROM BOOK_BOOK
            INNER JOIN ISSUED_BOOK ON BOOK_BOOK.ISBN = ISSUED_BOOK.ISBN
            AND ISSUED_BOOK.RETURN_DATE <= %s AND ISSUED_BOOK.RETURN_DATE > %s
            WHERE ISSUED_BOOK.COUNT_EXTENSION =0
            OR ISSUED_BOOK.COUNT_EXTENSION IS NULL 
            GROUP BY TITLE
            ORDER BY COUNT( * ) DESC
            LIMIT 0 , 3
            )

sql = '''(
SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED) AS  'Month', BOOK_BOOK.SUBJECT_NAME AS  'Top Subject', COUNT( * ) AS  '#checkouts'
FROM BOOK_BOOK
INNER JOIN ISSUED_BOOK ON BOOK_BOOK.ISBN = ISSUED_BOOK.ISBN
AND ISSUED_BOOK.RETURN_DATE <=  %s AND 
ISSUED_BOOK.RETURN_DATE >  %s
WHERE ISSUED_BOOK.COUNT_EXTENSION =0
OR ISSUED_BOOK.COUNT_EXTENSION IS NULL 
GROUP BY SUBJECT_NAME
ORDER BY COUNT( * ) DESC
)
UNION (

SELECT MONTH( ISSUED_BOOK.DATE_OF_ISSUED) AS  'Month', BOOK_BOOK.SUBJECT_NAME AS  'Top Subject', COUNT( * ) AS  '#checkouts'
FROM BOOK_BOOK
INNER JOIN ISSUED_BOOK ON BOOK_BOOK.ISBN = ISSUED_BOOK.ISBN
AND ISSUED_BOOK.RETURN_DATE <= %s 
AND ISSUED_BOOK.RETURN_DATE >  %s
WHERE ISSUED_BOOK.COUNT_EXTENSION =0
OR ISSUED_BOOK.COUNT_EXTENSION IS NULL 
GROUP BY SUBJECT_NAME
ORDER BY COUNT( * ) DESC
)
LIMIT 0 , 6'''





